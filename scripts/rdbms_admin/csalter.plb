set serveroutput on;
insert into csm$dictusers 
  select distinct u.user#, u.name from sys.user$ u 
  where u.name in ('HR', 'OE', 'SH', 'PM')
    or u.name like 'APEX\_%' escape '\';
create or replace function csm$rundml wrapped 
a000000
1
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
8
102 f3
Ku7Of/ePHTQvbCjNgzvJsAv6Wegwg1zQLcusZ3RAkBAYy8vIL1sftvQddpSWNxxhv9vwNYBS
UM75HMFscMa79rVhSYCXJ4S4EtATscFCLCz0castOwK8cDLRMJzhjDJZDvrg8HSjPKaXf1mU
OLmzKFZp9A0bluiLavPlwo2vsCAuByEwGxtH11HVVHwIG9Yw6WFLcyKyzXTZfDRRwN9ZY7Xe
5X+sUnLYhoI/ggmNZLznejUF

/
create or replace function csm$createsql wrapped 
a000000
1
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
8
7f7 3f1
LaR82Nqb5u/suAc0Af3OAjCgoSswgztcmiCDfC8ZgqqVocoCEfOsSCUaySY2r4nD9Nd+sM26
d7PDHjY41qAS7tCaOoDTCYNKB5NnzXLBmLv/mr4DiUBl4I6nmDIgvte7l8/+Ej27pllJofW9
VxHsWef+L1GUyahnVpRGgOuniBNx3l2mCSv1bi9wJkYefyjBCz/o310wUQg8QJluhYnrq6la
cFYIYm9l92lqc7OligMev8qRLQgJu8+rxc/Uk1E8llL6IZLlALLBuH5ks+9uB1ZjWudmxfps
7hgYdQg2g2nl5g3KmXZntsCIs8srNiSs2xSJDl7mHTyJrvN3ChxoR71JIxmyR2zOZKQ7ntiu
BtfDW1KDstIuOt8nIda8vo9tqFPA3BGAXqDRZMZSJxA8AT3chPfSbwtKNRTuFUXqfx2AzReX
CS9YPoUImpveZF0PHGzaM4B9jvr4Lm+goR3DHKWHZvzJrpfWQeyFPhx/KJIrZn1h06xc5EKP
enNFxhk2F51k20ua2h1xg5nUlIqb03R/5MU9kFvl8OlAPzl+NRFADnDyqbK8aRSSU+43A9nq
OsJG+MZMOlSPkb6Ijr8eaGqxOKVLTL/uOJiTE7DgAyOjH9puhovJPWoszk7vmouX9U5zF3hp
d0cBgQ1HcZWl4lNkslC+kro40On0SiF+sD3/wjCHb0OVUAirPLEPaCtvXmVtFvqlqFq2J8KI
Qj2Yjzfesb/XcnrrmOK5B5/NhWK9XiYKGnO0vCQoQCeUgmF8J0tikcvX43TBiBd45k+Erasq
n+UZZGKy8FltfWy/sSSV+anPc8LKH9lOHkQ0XxBNOyNFmh08tN7PIZABYJC/KvhXJT1ljJSj
671ggDia47rtjxjh8g4w/8QBLGyRUnfL08eg6Ikay6RhOat7jd6BWd5HeUOUmZsPrTiWT1m9
eQ849VQpbwDA/fqeZPB3Wfrc6p2z6Uc2LQAZET3k1Q1COqR6/KrOmfU5OnQ=

/
create or replace procedure csm$main wrapped 
a000000
1
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
7
123b 7db
DZQyx4r4T9QIyjGrVaikpOjLmnYwg+1UeSCDWi+8cuQY99P6XaLzUEGj96xdtAylkA9TTBMb
T1bGfm273RphoQVeP+TX4g+2ygIZmQnIWExyR4JOR4p+yXez47nM4ThFIg9bzHTF9vsExz3S
56a0QTLpfWwYVD7sCsMT5fVQP1WYL5m2TDICNC3qncJfHrBmmIk9ZmqfwUZREcllLKrIHnG5
fyd9rpqf4j8Q0SUOziGOuRi0uxvHYsTugQ6x2XMzBGthJ/cjKS68j+XqCbwDZ5Ao7M3f0g/3
9mpIvW2bCqYhdq+WnDujcTRA4PCTwXcDMtl+1Zm8BogH0PrJYtaqLBSvq2yhng+neu4vhnL3
URFZKkzmc/Q4/X7y9enMGoIH0mBSl7d0UVcFerH4L9hhenm76zH76VhNG+9NTH2cOXwBR796
v4u+TOROLmobeem6m6VyFvk2bcqZRv8R8wGaRVVIgYe9bvO3EeJ0oOPwXgfP5qSZ9a4qxxTU
NoM9g/gtFUhYwPu5ibRjvHPiVAUh1trLUywvSMLwqLpgPho401UXAW6iTeMezNq1oX6kst+2
w84mrUHNYaq8hRBi8mcjeyQXRn9qLe5qiXAtw7yrdH7G6SJ1shSVE4b5fy+0G6G8rxuH9JbL
Pq7rEbYdrOcrCtcfvFeIBIpmt8uQuwYVUzIXd1gtTuF1pioJftiAGolSzYJ58lY9gCuZ0pfL
1P6G8dLGcD0E68P9HMht4YZ78rE1b9Gdt7CeWbbzI9EF/9W4pA96DWOEpENvJGRWHo3iavV7
MIKgX6i2kfG0TitsgVrkUUjJxelQVLKKoXRxamYiRVDdbp0APxJ0w7/6a6kTpfWYl3CIGt2d
GYC9D8qP4dctd0eMYn9LYPnLkijvaUZSmu2Q9zk2K+guzC5OTdMTfurVkym/NRjSdB3610aq
GfkE8WrpG90RSimTn/RGacWraFPEurrtC89JD4Q/T6g9rHbhz2h+hkRhYPTvi6H3E4z9Anpq
QIwVTyxH1xZyX1eTn4LWQphsEuwsHJBqzLXIDzOdKXUQrBcz+7H8gg5cKfrEItloodgWO28i
9jNxJR0jDlFVvQ3/YBA64we9ALeQMUvzZxB0kD3yMoTHAuNMqYQ1vyByGdD4czXpAh+0n6lI
h26luE4+SvkV4qRI4IrHk/XEBsbAu706/J8ZV2lPybxcxjz5D6zayNBJlTMk48l2jmyk0VKg
vVLCr16C+MY1ImmjPcg9bi2sjaCSYtfOqzB258RQCaeiff9Retu/i6DWxUa1qn655HK6vEP5
EMK9zB2ugABw7ILv721Uy+0ALg+lMXI8lvx7RBpQhSwwbmNXFss5u4edHZzlo1KDEcvcu3jR
dZHcWX2/cAZpzxo62KMFs0DvWH5ul5h9md810GUHhzzr6FSvi9tauh5nDKFSWst/xMzs6X8i
futd2B0TmCT//K+ttu6WB4t8P+d4Co6hOftl+6rok8rU7o7gUvGU5tFU8W240jtTs87DGUea
h3pOrklXeLYklnbuSeGnv6e7SHb1mxNZiI6EdLs9n8CEIShJiM1DOvhKquasnJQ3xzD3Zl+e
1MU7Zkh7/9jMEI1YvVINJtA+FxGhK4ZBwI79x50Qkw0ScLxTxDeO7KSK+oRCrf1K/PuS3TkB
EtBE/xO9H4lWTtoVBIWBbkSsyu9DCPMXhFJ1DU+YwtC7AmJ2ESd7iiOguy4x6T6v7i8yXcZx
sFeIbeOUr33DHwfcQvo0tB/K9+IVUASSck7H4wQ6/dDQnhQTliYRrGVpqVIW1wbg6kZsxGJh
OVHJwMVD63EBQI8BL9yCIxouVjQdGxNV/pFmcC61FrJwLCgzU2utpwFTPTE38+UQnd5Wd17I
MI4CMJNZ5jKvdcvv6bUKxbwypSuaZ1VTUJldmwmW6IKVYxyHmtA6u/u+s4VHlf1M3o5yz/12
GojLRrLCzMYhZMPNxNMEXLJgpTK6neQpINTG6K8=

/
prompt This script will update the content of the Oracle Data Dictionary. 
prompt Please ensure you have a full backup before initiating this procedure.
accept conf char prompt 'Would you like to proceed (Y/N)?';
declare
begin

       
    
    if (UPPER('&conf') <> 'Y') then
       return;
    end if;

    csm$main();
    return;

end;
/
declare
   svalue   varchar2(30);
   sqlstmt  varchar2(1024);
   tochar   varchar2(30);
   rowcnt   number;
begin

    
    select value into svalue from csm$parameters where name='CSALTER_FINISHED';
    if (svalue <> 'TRUE') then
       dbms_output.put_line('Checking or Converting phase did not finish successfully');
       dbms_output.put_line('No database (national) character set will be altered');
       dbms_output.put_line('CSALTER finished unsuccessfully.');
       return;
    end if;

     
    select value into svalue from csm$parameters where name='SCAN_CHAR';
    if (svalue = 'YES') then
       dbms_output.put_line('Alter the database character set...');
       select value into tochar from csm$parameters where name='TO_CHARSET_NAME';
       rowcnt := csm$rundml('alter database character set internal_use '||tochar);
       commit;
    end if;

    
    select value into svalue from csm$parameters where name='SCAN_NCHAR';
    if (svalue = 'YES') then
       dbms_output.put_line('Alter the national database character set...');
       select value into tochar from csm$parameters where name='TO_NCHARSET_NAME';
       rowcnt := csm$rundml('alter database national character set internal_use '||tochar);
       commit;
    end if;
    
    dbms_output.put_line('CSALTER operation completed, please restart database');
end;
/
delete from csm$dictusers where username in ('PM', 'SH', 'HR', 'OE');
drop function csm$rundml;
drop function csm$createsql;
drop procedure csm$main; 
